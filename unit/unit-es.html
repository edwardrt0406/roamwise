<!DOCTYPE html><html lang="es-ES"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roamwise - Conversor de Unidades</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&amp;display=swap" rel="stylesheet">
    <style>
        :root{--primary:#2563eb;--primary-dark:#1d4ed8;--primary-light:#dbeafe;--accent:#f59e0b;--bg:#f0f4f8;--card:#fff;--text:#1e293b;--text-light:#64748b;--border:#e2e8f0;--radius:12px;--shadow:0 4px 24px rgba(0,0,0,.07);--shadow-sm:0 2px 8px rgba(0,0,0,.05);--green:#10b981;--red:#ef4444}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column}

        header{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(37,99,235,.3)}
        .logo{font-size:1.4rem;font-weight:700;letter-spacing:1px;display:flex;align-items:center;gap:8px}.logo span{color:var(--accent)}
        .header-right{display:flex;align-items:center;gap:16px}
        .header-right a{color:rgba(255,255,255,.85);text-decoration:none;font-size:.9rem;transition:color .2s}.header-right a:hover{color:#fff}
        .lang-select{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);color:#fff;padding:6px 12px;border-radius:8px;font-size:.85rem;cursor:pointer;font-family:inherit}.lang-select option{color:#333;background:#fff}

        main{flex:1;max-width:920px;width:100%;margin:0 auto;padding:32px 16px}
        .page-title{text-align:center;font-size:1.7rem;font-weight:700;margin-bottom:24px;color:var(--primary-dark)}
        .info-box{background:var(--primary-light);border-left:4px solid var(--primary);border-radius:0 var(--radius) var(--radius) 0;padding:16px 20px;margin-bottom:24px;display:flex;gap:12px;align-items:flex-start;font-size:.92rem;color:var(--primary-dark);line-height:1.6}.info-box .icon{font-size:1.2rem;flex-shrink:0;margin-top:2px}

        .cat-tabs-wrap{margin-bottom:22px;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;padding-bottom:4px}
        .cat-tabs-wrap::-webkit-scrollbar{display:none}
        .cat-tabs{display:flex;gap:8px;min-width:max-content}
        .cat-chip{padding:10px 16px;border-radius:24px;border:2px solid var(--border);background:#fff;font-size:.88rem;cursor:pointer;font-family:inherit;transition:all .2s;display:flex;align-items:center;gap:6px;white-space:nowrap;font-weight:500;color:var(--text)}
        .cat-chip:hover{border-color:var(--primary);background:var(--primary-light);color:var(--primary-dark)}
        .cat-chip.active{border-color:var(--primary);background:var(--primary);color:#fff;box-shadow:0 4px 12px rgba(37,99,235,.25)}
        .cat-chip .ci{font-size:1.05rem}

        .converter-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:28px 24px;margin-bottom:20px}
        .converter-row{display:flex;gap:12px;align-items:stretch}
        .conv-side{flex:1;min-width:0}
        .conv-side label{font-weight:500;font-size:.9rem;margin-bottom:8px;display:flex;align-items:center;gap:6px}
        .unit-select{width:100%;padding:12px 40px 12px 14px;border:2px solid var(--border);border-radius:10px;background:#fff;font-size:.93rem;font-family:inherit;font-weight:600;cursor:pointer;appearance:none;-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2364748b' viewBox='0 0 16 16'%3E%3Cpath d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;transition:border-color .2s;margin-bottom:10px;color:var(--text)}
        .unit-select:focus,.unit-select:hover{border-color:var(--primary);outline:none;box-shadow:0 0 0 3px rgba(37,99,235,.1)}
        .amount-input{width:100%;padding:14px 16px;border:2px solid var(--border);border-radius:10px;font-size:1.45rem;font-family:inherit;font-weight:700;text-align:right;transition:border-color .2s,box-shadow .2s;color:var(--text)}
        .amount-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(37,99,235,.12)}
        .amount-input.result{background:#f8fafc;color:var(--primary-dark)}
        .swap-col{display:flex;align-items:center;justify-content:center;flex-shrink:0;padding-top:28px}
        .swap-btn{width:48px;height:48px;border-radius:50%;border:2px solid var(--border);background:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.3rem;transition:all .25s;color:var(--primary)}
        .swap-btn:hover{background:var(--primary);color:#fff;border-color:var(--primary);transform:rotate(180deg);box-shadow:0 4px 16px rgba(37,99,235,.3)}

        .formula-display{text-align:center;margin-top:16px;padding:14px;background:linear-gradient(135deg,#f8fafc,#eff6ff);border-radius:10px;border:1px solid var(--border);position:relative}
        .formula-main{font-size:1.03rem;font-weight:600;color:var(--text);margin-bottom:3px;font-variant-numeric:tabular-nums}
        .formula-reverse{font-size:.86rem;color:var(--text-light);font-variant-numeric:tabular-nums}

        .copy-row{display:flex;justify-content:center;gap:10px;margin-top:12px}
        .copy-btn{display:inline-flex;align-items:center;gap:6px;padding:9px 20px;border:1.5px solid var(--border);border-radius:9px;background:#fff;cursor:pointer;font-size:.87rem;font-family:inherit;color:var(--text-light);font-weight:500;transition:all .2s}
        .copy-btn:hover{border-color:var(--primary);color:var(--primary);background:var(--primary-light)}
        .copy-btn.copied{border-color:var(--green);color:var(--green);background:#ecfdf5}

        .toast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%) translateY(80px);background:#1e293b;color:#fff;padding:13px 28px;border-radius:11px;font-size:.92rem;z-index:1000;opacity:0;transition:all .35s cubic-bezier(.4,0,.2,1);pointer-events:none;box-shadow:0 8px 32px rgba(0,0,0,.2);display:flex;align-items:center;gap:8px;white-space:nowrap}
        .toast.show{transform:translateX(-50%) translateY(0);opacity:1}

        .section-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-sm);border:1px solid var(--border);padding:22px 20px;margin-bottom:20px}
        .section-card h3{font-size:1rem;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--text)}

        .all-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:10px}
        .all-tile{border:1px solid var(--border);border-radius:10px;padding:11px 13px;display:flex;flex-direction:column;gap:4px;transition:all .15s;cursor:pointer}
        .all-tile:hover{border-color:var(--primary);box-shadow:var(--shadow-sm)}
        .all-tile.highlight{border-color:var(--primary);background:var(--primary-light)}
        .all-tile .at-name{font-size:.78rem;color:var(--text-light);display:flex;align-items:center;gap:4px}
        .all-tile .at-value{font-size:1.05rem;font-weight:700;color:var(--text);font-variant-numeric:tabular-nums;word-break:break-all}
        .all-tile.highlight .at-value{color:var(--primary-dark)}

        .ref-item{padding:10px 14px;background:#f8fafc;border-radius:8px;margin-bottom:8px;font-size:.9rem;line-height:1.6;border-left:3px solid var(--accent);color:var(--text)}
        .ref-item:last-child{margin-bottom:0}

        .tip-item{margin-bottom:10px;font-size:.92rem;line-height:1.8}
        .tip-item:last-child{margin-bottom:0}

        .calc-note{font-size:.82rem;color:var(--text-light);line-height:1.6;padding:12px 16px;background:#f8fafc;border-radius:8px;margin-top:8px}

        footer{background:#1e293b;color:rgba(255,255,255,.7);padding:36px 24px 20px;margin-top:auto}
        .footer-grid{max-width:920px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:28px;margin-bottom:28px}
        .footer-col h4{color:#fff;font-size:.95rem;margin-bottom:12px;display:flex;align-items:center;gap:6px}
        .footer-col a{display:block;color:rgba(255,255,255,.6);text-decoration:none;font-size:.88rem;padding:4px 0;transition:color .2s}.footer-col a:hover{color:#fff}
        .footer-col a.active-link{color:var(--accent);font-weight:500}
        .footer-bottom{text-align:center;border-top:1px solid rgba(255,255,255,.1);padding-top:16px;font-size:.82rem}.footer-bottom a{color:rgba(255,255,255,.5);text-decoration:none}.footer-bottom a:hover{color:#fff}

        @media(max-width:640px){
            .page-title{font-size:1.3rem}
            .converter-row{flex-direction:column}
            .swap-col{padding-top:0;padding-bottom:0}.swap-btn{transform:rotate(90deg)}.swap-btn:hover{transform:rotate(270deg)}
            .amount-input{font-size:1.2rem}
            .all-grid{grid-template-columns:1fr 1fr}
            .header-right a.contact-link{display:none}
            .converter-card{padding:20px 16px}
            .cat-chip{padding:9px 13px;font-size:.83rem}
        }
    </style>

<header>
    <div class="logo">
        <img src="logo.png" alt="Roamwise Logo" class="logo-img">
        Roam<span>wise</span>
    </div>
    <div class="logo">Roam<span>wise</span></div>
    <div class="header-right">
        <a href="#" class="contact-link">Cont√°ctenos</a>
        <select class="lang-select" id="langSelect">
            <option value="unit-zh.html">Chino tradicional</option>
            <option value="unit-en.html">Ingl√©s</option>
            <option value="unit-es.html" selected="">Espa√±ol</option>
            <option value="unit-pt.html">Portugu√©s</option>
        </select>
    </div>
</header>
    
<script>
    function changeLanguage(filename) {
        window.location.href = filename;
    }
</script>

<main>
    <h1 class="page-title">üìê Conversor de Unidades</h1>
    <div class="info-box"><span class="icon">‚ÑπÔ∏è</span><div>Admite conversi√≥n en tiempo real en <strong>10 grandes categor√≠as</strong>: Longitud, Peso, Temperatura, √Årea, Volumen, Velocidad, Tiempo, Datos, Energ√≠a y Potencia. Incluye unidades de Taiw√°n (ping, catty taiwan√©s), Hong Kong/Macao (pie cuadrado, catty de HK) y unidades internacionales est√°ndar. Los resultados se muestran autom√°ticamente al introducir un valor.</div></div>

    <div class="cat-tabs-wrap"><div class="cat-tabs" id="catTabs"></div></div>

    <div class="converter-card">
        <div class="converter-row">
            <div class="conv-side">
                <label>üìå Desde</label>
                <select class="unit-select" id="fromUnit"></select>
                <input type="text" inputmode="decimal" class="amount-input" id="fromAmount" value="1" placeholder="Introducir valor">
            </div>
            <div class="swap-col"><button class="swap-btn" id="swapBtn" title="Intercambiar">‚áÑ</button></div>
            <div class="conv-side">
                <label>üìå Convertir a</label>
                <select class="unit-select" id="toUnit"></select>
                <input type="text" class="amount-input result" id="toAmount" placeholder="Resultado" inputmode="decimal">
            </div>
        </div>
        <div class="formula-display" id="formulaDisplay">
            <div class="formula-main" id="formulaMain"></div>
            <div class="formula-reverse" id="formulaReverse"></div>
        </div>
        <div class="copy-row">
            <button class="copy-btn" id="copyFormula"><span>üìã</span> Copiar f√≥rmula</button>
            <button class="copy-btn" id="copyResult"><span>üìã</span> Copiar resultado</button>
        </div>
    </div>

    <div class="section-card">
        <h3 id="allTitle">üìã Todas las conversiones de unidades</h3>
        <div class="all-grid" id="allGrid"></div>
    </div>

    <div class="section-card" id="refSection">
        <h3>üìù Referencias comunes</h3>
        <div id="refList"></div>
    </div>

    <div class="section-card">
        <h3>üí° Consejos de conversi√≥n</h3>
        <div style="font-size:.92rem;line-height:1.8;color:var(--text)">
            <p class="tip-item">üåç <strong>Sistema m√©trico vs imperial</strong>: La mayor√≠a de los pa√≠ses utilizan el sistema m√©trico (metros, kilogramos), mientras que Estados Unidos, Myanmar y Liberia usan principalmente el sistema imperial (millas, libras). Conocer el sistema de unidades local antes de viajar facilita la comunicaci√≥n cotidiana.</p>
            <p class="tip-item">üè† <strong>√Årea en HK y Macao</strong>: Los inmuebles en Hong Kong y Macao se valoran en <strong>pies cuadrados (ft¬≤)</strong>. 1 pie cuadrado ‚âà 0,093 m¬≤. En Taiw√°n se usa habitualmente el ¬´ping¬ª, donde 1 ping ‚âà 3,3 m¬≤ ‚âà 35,6 ft¬≤.</p>
            <p class="tip-item">‚öñÔ∏è <strong>Unidades de peso: Taiw√°n vs HK</strong>: Catty taiwan√©s = 600g, tael taiwan√©s = 37,5g; catty de HK ‚âà 604,8g, tael de HK ‚âà 37,8g. La diferencia es peque√±a, pero conviene tenerla en cuenta en los mercados tradicionales.</p>
            <p class="tip-item">üå°Ô∏è <strong>Lectura de temperatura</strong>: EE. UU. usa Fahrenheit (¬∞F); la mayor√≠a de los dem√°s pa√≠ses usan Celsius (¬∞C). Estimaci√≥n mental r√°pida: ¬∞F ‚âà ¬∞C √ó 2 + 30.</p>
            <p class="tip-item">‚ö° <strong>Facturaci√≥n el√©ctrica</strong>: La electricidad en Taiw√°n y Hong Kong/Macao se factura en kilovatios-hora (kWh). 1 kWh = 1.000 vatios-hora = 3.600 kilojulios. Conocer la potencia de los electrodom√©sticos ayuda a estimar el coste el√©ctrico.</p>
            <p class="tip-item">‚õΩ <strong>Conversi√≥n de consumo de combustible</strong>: Taiw√°n usa km/L, EE. UU. usa MPG (millas por gal√≥n) y Europa usa L/100 km. Comprueba el m√©todo de medici√≥n local antes de repostar.</p>
        </div>
    </div>

    <div class="calc-note">‚ö†Ô∏è Los resultados de conversi√≥n de este sitio son solo de referencia. Algunas unidades (p. ej., meses, a√±os) usan valores aproximados. El caballo de vapor m√©trico (PS) y el imperial (hp) difieren ligeramente. Para uso cient√≠fico o de ingenier√≠a, consulte los valores est√°ndar precisos.</div>
</main>

<footer>
    <div class="footer-grid">
        <div class="footer-col">
            <h4>üîå Electricidad y Hora</h4>
            <a href="../plug/plug-es.html">B√∫squeda de Especificaciones de Enchufe</a>
            <a href="../time-zone/time-zone-es.html">B√∫squeda de Zona Horaria</a>
            <a href="../timer/timer-es.html">Temporizador y Cuenta Atr√°s</a>
            <a href="../sunset/sunset-es.html">Horarios de Amanecer y Atardecer</a>
        </div>
        <div class="footer-col">
            <h4>üéâ Festivos y Festivales</h4>
            <a href="#">D√≠as Festivos por Pa√≠s</a>
            <a href="#">Resumen de Eventos Festivos</a>
        </div>
        <div class="footer-col">
            <h4>üí± Finanzas y Unidades</h4>
            <a href=".../currency/currency-es.html">Conversi√≥n de Divisas</a>
            <a href="../unit/unit-es.html"  class="active-link">Conversi√≥n de Unidades</a>
        </div>
        <div class="footer-col">
            <h4>üåç Informaci√≥n de Viaje</h4>
            <a href="#">Resumen por Pa√≠s</a>
            <a href="#">Gu√≠as Locales Detalladas</a>
        </div>
    </div>
    <div class="footer-bottom">¬© 2026 Roamwise. Todos los derechos reservados. | <a href="#">Pol√≠tica de Privacidad</a> | <a href="#">T√©rminos de Uso</a></div>
</footer>

<div class="toast" id="toast"></div>

<script>
// ============ DATA ============
const categories=[
{id:'length',name:'Longitud',icon:'üìè',dfFrom:'cm',dfTo:'in',
 units:[
  {code:'mm',name:'Mil√≠metro',sym:'mm',toBase:0.001},
  {code:'cm',name:'Cent√≠metro',sym:'cm',toBase:0.01},
  {code:'m',name:'Metro',sym:'m',toBase:1},
  {code:'km',name:'Kil√≥metro',sym:'km',toBase:1000},
  {code:'in',name:'Pulgada',sym:'in',toBase:0.0254},
  {code:'ft',name:'Pie',sym:'ft',toBase:0.3048},
  {code:'yd',name:'Yarda',sym:'yd',toBase:0.9144},
  {code:'mi',name:'Milla',sym:'mi',toBase:1609.344},
  {code:'nmi',name:'Milla n√°utica',sym:'nmi',toBase:1852}
 ],
 refs:['1 pie = 12 pulgadas ‚âà 30,48 cm, de uso com√∫n en Hong Kong y Macao','Altura media de un hombre adulto: 170 cm ‚âà 5 pies 7 pulgadas','Distancia de marat√≥n completo: 42,195 km ‚âà 26,2 mi','Longitud del papel A4 ‚âà 29,7 cm ‚âà 11,69 pulgadas']
},
{id:'weight',name:'Peso',icon:'‚öñÔ∏è',dfFrom:'kg',dfTo:'lb',
 units:[
  {code:'mg',name:'Miligramo',sym:'mg',toBase:0.001},
  {code:'g',name:'Gramo',sym:'g',toBase:1},
  {code:'kg',name:'Kilogramo',sym:'kg',toBase:1000},
  {code:'ton',name:'Tonelada m√©trica',sym:'t',toBase:1000000},
  {code:'oz',name:'Onza',sym:'oz',toBase:28.3495},
  {code:'lb',name:'Libra',sym:'lb',toBase:453.592},
  {code:'jin',name:'Catty taiwan√©s (Jin)',sym:'tw.jin',toBase:600},
  {code:'tliang',name:'Tael taiwan√©s (Liang)',sym:'tw.liang',toBase:37.5},
  {code:'hkjin',name:'Catty de HK (Sƒ´m«é Jin)',sym:'hk.jin',toBase:604.79},
  {code:'hkliang',name:'Tael de HK (Sƒ´m«é Liang)',sym:'hk.liang',toBase:37.799},
  {code:'st',name:'Stone',sym:'st',toBase:6350.29}
 ],
 refs:['Catty taiwan√©s = 600g (16 taeles taiwaneses), catty de HK ‚âà 604,8g (16 taeles de HK), ligeramente diferentes','1 lb ‚âà 453,6g ‚âà 0,756 catty taiwan√©s ‚âà 0,75 catty de HK','El l√≠mite de equipaje de aerol√≠nea suele ser 23 kg ‚âà 50,7 lb ‚âà 38,3 catties taiwaneses','1 onza ‚âà 28,35g','El tael de HK (Sƒ´m«é Liang) se usa habitualmente en el comercio de oro; 1 tael de HK ‚âà 37,8g']
},
{id:'temp',name:'Temperatura',icon:'üå°Ô∏è',dfFrom:'C',dfTo:'F',isTemp:true,
 units:[
  {code:'C',name:'Celsius',sym:'¬∞C'},
  {code:'F',name:'Fahrenheit',sym:'¬∞F'},
  {code:'K',name:'Kelvin',sym:'K'}
 ],
 refs:['Punto de congelaci√≥n del agua: 0 ¬∞C = 32 ¬∞F = 273,15 K','Temperatura corporal normal: 37 ¬∞C ‚âà 98,6 ¬∞F','Rango de temperatura ambiente confortable: 20‚Äì25 ¬∞C ‚âà 68‚Äì77 ¬∞F','Punto de ebullici√≥n del agua: 100 ¬∞C = 212 ¬∞F = 373,15 K']
},
{id:'area',name:'√Årea',icon:'üìê',dfFrom:'ft2',dfTo:'m2',
 units:[
  {code:'cm2',name:'Cent√≠metro cuadrado',sym:'cm¬≤',toBase:0.0001},
  {code:'m2',name:'Metro cuadrado',sym:'m¬≤',toBase:1},
  {code:'km2',name:'Kil√≥metro cuadrado',sym:'km¬≤',toBase:1e6},
  {code:'ha',name:'Hect√°rea',sym:'ha',toBase:10000},
  {code:'ping',name:'Ping (Âù™)',sym:'ping',toBase:3.305785},
  {code:'jia',name:'Jia (Áî≤)',sym:'jia',toBase:9699.17},
  {code:'ft2',name:'Pie cuadrado',sym:'ft¬≤',toBase:0.092903},
  {code:'yd2',name:'Yarda cuadrada',sym:'yd¬≤',toBase:0.836127},
  {code:'ac',name:'Acre',sym:'ac',toBase:4046.86}
 ],
 refs:['Los inmuebles en Hong Kong y Macao se valoran en pies cuadrados (ft¬≤); 1 ft¬≤ ‚âà 0,093 m¬≤','1 ping ‚âà 3,306 m¬≤ ‚âà 35,58 ft¬≤ (unidad habitual en el mercado inmobiliario taiwan√©s)','Un piso peque√±o t√≠pico en Hong Kong es de 300‚Äì400 ft¬≤ ‚âà 27,9‚Äì37,2 m¬≤ ‚âà 8,4‚Äì11,2 ping','1 Jia ‚âà 2.934 ping ‚âà 0,97 hect√°reas (unidad habitual para tierras de cultivo en Taiw√°n)','Campo de f√∫tbol est√°ndar ‚âà 7.140 m¬≤ ‚âà 76.854 ft¬≤']
},
{id:'volume',name:'Volumen',icon:'üß™',dfFrom:'L',dfTo:'galUS',
 units:[
  {code:'mL',name:'Mililitro',sym:'mL',toBase:1},
  {code:'L',name:'Litro',sym:'L',toBase:1000},
  {code:'cc',name:'Cent√≠metro c√∫bico',sym:'cc',toBase:1},
  {code:'m3',name:'Metro c√∫bico',sym:'m¬≥',toBase:1e6},
  {code:'tsp',name:'Cucharadita',sym:'tsp',toBase:4.929},
  {code:'tbsp',name:'Cucharada',sym:'tbsp',toBase:14.787},
  {code:'cupUS',name:'Taza americana',sym:'cup',toBase:236.588},
  {code:'flozUS',name:'Onza l√≠quida',sym:'fl oz',toBase:29.5735},
  {code:'galUS',name:'Gal√≥n americano',sym:'gal(US)',toBase:3785.41},
  {code:'galUK',name:'Gal√≥n imperial',sym:'gal(UK)',toBase:4546.09}
 ],
 refs:['1 litro = 1.000 mL = 1.000 cc','1 gal√≥n americano ‚âà 3,785 L; 1 gal√≥n imperial ‚âà 4,546 L','1 taza americana ‚âà 237 mL (medida est√°ndar de reposter√≠a)','1 onza l√≠quida ‚âà 29,6 mL']
},
{id:'speed',name:'Velocidad',icon:'üöÄ',dfFrom:'kmh',dfTo:'mph',
 units:[
  {code:'ms',name:'Metros por segundo',sym:'m/s',toBase:1},
  {code:'kmh',name:'Kil√≥metros por hora',sym:'km/h',toBase:0.277778},
  {code:'mph',name:'Millas por hora',sym:'mph',toBase:0.44704},
  {code:'kn',name:'Nudo',sym:'kt',toBase:0.514444},
  {code:'fts',name:'Pies por segundo',sym:'ft/s',toBase:0.3048},
  {code:'mach',name:'Mach',sym:'Mach',toBase:343}
 ],
 refs:['L√≠mite de velocidad en autopista: 110 km/h ‚âà 68,4 mph','1 nudo = 1,852 km/h (habitual en n√°utica y aviaci√≥n)','Velocidad del sonido (nivel del mar, 20 ¬∞C) ‚âà 343 m/s ‚âà 1.235 km/h','Velocidad del r√©cord mundial de 100 m ‚âà 37,6 km/h ‚âà 23,4 mph']
},
{id:'time',name:'Tiempo',icon:'‚è±Ô∏è',dfFrom:'hr',dfTo:'min',
 units:[
  {code:'msec',name:'Milisegundo',sym:'ms',toBase:0.001},
  {code:'sec',name:'Segundo',sym:'s',toBase:1},
  {code:'min',name:'Minuto',sym:'min',toBase:60},
  {code:'hr',name:'Hora',sym:'hr',toBase:3600},
  {code:'day',name:'D√≠a',sym:'day',toBase:86400},
  {code:'wk',name:'Semana',sym:'wk',toBase:604800},
  {code:'mo',name:'Mes (‚âà30 d√≠as)',sym:'mo',toBase:2592000},
  {code:'yr',name:'A√±o (‚âà365 d√≠as)',sym:'yr',toBase:31536000}
 ],
 refs:['1 d√≠a = 24 horas = 1.440 minutos = 86.400 segundos','1 semana = 7 d√≠as = 168 horas','De Taip√©i a Tokio ‚âà 3 horas = 180 minutos','De Taip√©i a Hong Kong ‚âà 1 hora 50 minutos']
},
{id:'data',name:'Datos',icon:'üíæ',dfFrom:'GB',dfTo:'MB',
 units:[
  {code:'bit',name:'Bit',sym:'bit',toBase:0.125},
  {code:'B',name:'Byte',sym:'B',toBase:1},
  {code:'KB',name:'Kilobyte',sym:'KB',toBase:1024},
  {code:'MB',name:'Megabyte',sym:'MB',toBase:1048576},
  {code:'GB',name:'Gigabyte',sym:'GB',toBase:1073741824},
  {code:'TB',name:'Terabyte',sym:'TB',toBase:1099511627776},
  {code:'PB',name:'Petabyte',sym:'PB',toBase:1125899906842624}
 ],
 refs:['1 KB = 1.024 bytes','1 MB = 1.024 KB = 1.048.576 B','1 GB = 1.024 MB (puede almacenar aprox. 250 canciones MP3)','1 TB = 1.024 GB (puede almacenar aprox. 250 pel√≠culas en HD)']
},
{id:'energy',name:'Energ√≠a',icon:'‚ö°',dfFrom:'kWh',dfTo:'kJ',
 units:[
  {code:'J',name:'Julio',sym:'J',toBase:1},
  {code:'kJ',name:'Kilojulio',sym:'kJ',toBase:1000},
  {code:'MJ',name:'Megajulio',sym:'MJ',toBase:1e6},
  {code:'cal',name:'Calor√≠a',sym:'cal',toBase:4.184},
  {code:'kcal',name:'Kilocalor√≠a',sym:'kcal',toBase:4184},
  {code:'Wh',name:'Vatio-hora',sym:'Wh',toBase:3600},
  {code:'kWh',name:'Kilovatio-hora',sym:'kWh',toBase:3600000},
  {code:'BTU',name:'Unidad t√©rmica brit√°nica',sym:'BTU',toBase:1055.06},
  {code:'eV',name:'Electronvoltio',sym:'eV',toBase:1.602176634e-19},
  {code:'ft_lb',name:'Pie-libra',sym:'ft¬∑lb',toBase:1.35582}
 ],
 refs:['1 kWh = 3.600 kJ = 860 kcal','Tarifa el√©ctrica residencial en Taiw√°n ‚âà NT$2,5‚Äì6,4/kWh (tarifa progresiva)','Tarifa el√©ctrica residencial en Hong Kong ‚âà HK$1,0‚Äì1,6/kWh','Un cuenco de arroz blanco ‚âà 280 kcal ‚âà 1.172 kJ','1 BTU ‚âà 1.055 J (unidad habitual para la capacidad de aire acondicionado)']
},
{id:'power',name:'Potencia',icon:'üîå',dfFrom:'kW',dfTo:'hp',
 units:[
  {code:'W',name:'Vatio',sym:'W',toBase:1},
  {code:'kW',name:'Kilovatio',sym:'kW',toBase:1000},
  {code:'MW',name:'Megavatio',sym:'MW',toBase:1e6},
  {code:'hp',name:'Caballo de vapor (imperial)',sym:'hp',toBase:745.7},
  {code:'PS',name:'Caballo de vapor (m√©trico)',sym:'PS',toBase:735.499},
  {code:'BTUh',name:'BTU/hora',sym:'BTU/h',toBase:0.293071},
  {code:'kcalh',name:'Kilocalor√≠a/hora',sym:'kcal/h',toBase:1.163},
  {code:'ftlbs',name:'Pie-libra/segundo',sym:'ft¬∑lb/s',toBase:1.35582}
 ],
 refs:['1 caballo de vapor imperial (hp) = 745,7 W; 1 caballo de vapor m√©trico (PS) = 735,5 W','Aire acondicionado dom√©stico de 1 tonelada de refrigeraci√≥n ‚âà 12.000 BTU/h ‚âà 3.517 W','Potencia t√≠pica de un microondas dom√©stico ‚âà 700‚Äì1.200 W','Potencia de un veh√≠culo el√©ctrico t√≠pico: 100‚Äì400 kW ‚âà 134‚Äì536 hp','Voltaje en Hong Kong: 220V/50Hz; en Taiw√°n: 110V/60Hz']
}
];

const catMap={};categories.forEach(c=>{catMap[c.id]=c});

// ============ STATE ============
let curCat='length';
let fromU,toU,lastEdited='from';

// ============ HELPERS ============
function getCat(){return catMap[curCat]}
function getUnit(cat,code){return cat.units.find(u=>u.code===code)}

function convertVal(val,fromCode,toCode,cat){
    if(cat.isTemp)return convertTemp(val,fromCode,toCode);
    const fu=getUnit(cat,fromCode),tu=getUnit(cat,toCode);
    if(!fu||!tu)return 0;
    return val*fu.toBase/tu.toBase;
}
function convertTemp(val,from,to){
    let c;
    if(from==='C')c=val;else if(from==='F')c=(val-32)*5/9;else c=val-273.15;
    if(to==='C')return c;if(to==='F')return c*9/5+32;return c+273.15;
}

function fmtNum(n){
    if(n===0)return '0';
    const a=Math.abs(n);
    if(a>=1e15||a<0.0001&&a!==0)return n.toExponential(4);
    let d;
    if(a>=10000)d=2;else if(a>=100)d=3;else if(a>=10)d=4;else if(a>=1)d=5;else if(a>=0.01)d=6;else d=8;
    return n.toLocaleString('zh-TW',{minimumFractionDigits:0,maximumFractionDigits:d});
}
function fmtRate(n){
    if(n===0)return '0';
    const a=Math.abs(n);
    if(a>=1e12||a<0.00001&&a!==0)return n.toExponential(4);
    let d;
    if(a>=1000)d=3;else if(a>=10)d=4;else if(a>=1)d=5;else if(a>=0.01)d=6;else d=8;
    return n.toLocaleString('zh-TW',{minimumFractionDigits:0,maximumFractionDigits:d});
}

// ============ DOM ============
const fromSel=document.getElementById('fromUnit');
const toSel=document.getElementById('toUnit');
const fromAmt=document.getElementById('fromAmount');
const toAmt=document.getElementById('toAmount');
const toastEl=document.getElementById('toast');

// Build tabs
const tabsEl=document.getElementById('catTabs');
categories.forEach(cat=>{
    const chip=document.createElement('button');
    chip.className='cat-chip'+(cat.id===curCat?' active':'');
    chip.dataset.id=cat.id;
    chip.innerHTML='<span class="ci">'+cat.icon+'</span>'+cat.name;
    chip.addEventListener('click',()=>switchCategory(cat.id));
    tabsEl.appendChild(chip);
});

function switchCategory(id){
    curCat=id;
    document.querySelectorAll('.cat-chip').forEach(c=>c.classList.toggle('active',c.dataset.id===id));
    const cat=getCat();
    fromU=cat.dfFrom;toU=cat.dfTo;
    populateSelects();
    fromAmt.value='1';lastEdited='from';
    doConvert();updateAllGrid();updateRefs();
}

function populateSelects(){
    const cat=getCat();
    fromSel.innerHTML='';toSel.innerHTML='';
    cat.units.forEach(u=>{
        const o1=document.createElement('option');
        o1.value=u.code;o1.textContent=u.name+' ('+u.sym+')';
        if(u.code===fromU)o1.selected=true;
        fromSel.appendChild(o1);
        const o2=document.createElement('option');
        o2.value=u.code;o2.textContent=u.name+' ('+u.sym+')';
        if(u.code===toU)o2.selected=true;
        toSel.appendChild(o2);
    });
}

function doConvert(){
    const cat=getCat();
    fromU=fromSel.value;toU=toSel.value;
    if(lastEdited==='from'){
        const v=parseFloat(fromAmt.value.replace(/,/g,''));
        if(isNaN(v)||fromAmt.value.trim()===''){toAmt.value='';updateFormula();return}
        toAmt.value=fmtNum(convertVal(v,fromU,toU,cat));
    }else{
        const v=parseFloat(toAmt.value.replace(/,/g,''));
        if(isNaN(v)||toAmt.value.trim()===''){fromAmt.value='';updateFormula();return}
        fromAmt.value=fmtNum(convertVal(v,toU,fromU,cat));
    }
    updateFormula();updateAllGrid();
}

function updateFormula(){
    const cat=getCat();
    const fu=getUnit(cat,fromU),tu=getUnit(cat,toU);
    if(!fu||!tu)return;
    const r1=convertVal(1,fromU,toU,cat),r2=convertVal(1,toU,fromU,cat);
    document.getElementById('formulaMain').textContent='1 '+fu.name+' ('+fu.sym+') = '+fmtRate(r1)+' '+tu.name+' ('+tu.sym+')';
    document.getElementById('formulaReverse').textContent='1 '+tu.name+' ('+tu.sym+') = '+fmtRate(r2)+' '+fu.name+' ('+fu.sym+')';
}

function updateAllGrid(){
    const cat=getCat();const grid=document.getElementById('allGrid');grid.innerHTML='';
    let baseVal=parseFloat(fromAmt.value.replace(/,/g,''));
    if(isNaN(baseVal))baseVal=0;
    const fromCode=fromU;
    const fu=getUnit(cat,fromCode);
    document.getElementById('allTitle').textContent='üìã '+fmtNum(baseVal)+' '+(fu?fu.sym:'')+' equivale a‚Ä¶';
    cat.units.forEach(u=>{
        const tile=document.createElement('div');
        tile.className='all-tile';
        if(u.code===fromU||u.code===toU)tile.classList.add('highlight');
        const val=convertVal(baseVal,fromCode,u.code,cat);
        tile.innerHTML='<div class="at-name">'+u.name+' ('+u.sym+')</div><div class="at-value">'+fmtNum(val)+'</div>';
        tile.addEventListener('click',()=>{toU=u.code;toSel.value=u.code;lastEdited='from';doConvert()});
        grid.appendChild(tile);
    });
}

function updateRefs(){
    const cat=getCat();const list=document.getElementById('refList');list.innerHTML='';
    (cat.refs||[]).forEach(r=>{const d=document.createElement('div');d.className='ref-item';d.textContent=r;list.appendChild(d)});
}

// ============ COPY FUNCTIONS ============
function showToast(msg){
    toastEl.textContent='';
    toastEl.innerHTML='<span style="font-size:1.1rem">‚úÖ</span> '+msg;
    toastEl.classList.add('show');
    clearTimeout(showToast._t);
    showToast._t=setTimeout(()=>toastEl.classList.remove('show'),2200);
}

function getFormulaText(){
    const cat=getCat();const fu=getUnit(cat,fromU),tu=getUnit(cat,toU);
    if(!fu||!tu)return '';
    const r1=convertVal(1,fromU,toU,cat);
    return '1 '+fu.name+' ('+fu.sym+') = '+fmtRate(r1)+' '+tu.name+' ('+tu.sym+')';
}
function getResultText(){
    const cat=getCat();const fu=getUnit(cat,fromU),tu=getUnit(cat,toU);
    if(!fu||!tu)return '';
    const fv=fromAmt.value.trim(),tv=toAmt.value.trim();
    if(!fv||!tv)return '';
    return fv+' '+fu.name+' ('+fu.sym+') = '+tv+' '+tu.name+' ('+tu.sym+')';
}

function doCopy(text,btnEl){
    if(!text)return;
    navigator.clipboard.writeText(text).then(()=>{
        showToast('Copiado al portapapeles');
        btnEl.classList.add('copied');
        btnEl.innerHTML='<span>‚úÖ</span> Copiado';
        setTimeout(()=>{
            btnEl.classList.remove('copied');
            if(btnEl.id==='copyFormula')btnEl.innerHTML='<span>üìã</span> Copiar f√≥rmula';
            else btnEl.innerHTML='<span>üìã</span> Copiar resultado';
        },2000);
    }).catch(()=>{
        /* fallback for sandbox */
        const ta=document.createElement('textarea');ta.value=text;ta.style.position='fixed';ta.style.left='-9999px';
        document.body.appendChild(ta);ta.select();
        try{document.execCommand('copy');showToast('Copiado al portapapeles');btnEl.classList.add('copied');btnEl.innerHTML='<span>‚úÖ</span> Copiado';setTimeout(()=>{btnEl.classList.remove('copied');if(btnEl.id==='copyFormula')btnEl.innerHTML='<span>üìã</span> Copiar f√≥rmula';else btnEl.innerHTML='<span>üìã</span> Copiar resultado';},2000)}catch(e){}
        document.body.removeChild(ta);
    });
}

document.getElementById('copyFormula').addEventListener('click',function(){doCopy(getFormulaText(),this)});
document.getElementById('copyResult').addEventListener('click',function(){doCopy(getResultText(),this)});

// ============ INPUT EVENTS ============
function sanitizeInput(el,allowNeg){
    let v=el.value;
    if(allowNeg){v=v.replace(/[^0-9.\-]/g,'')}else{v=v.replace(/[^0-9.]/g,'')}
    // only one dot
    const pts=v.split('.');if(pts.length>2)v=pts[0]+'.'+pts.slice(1).join('');
    // only leading minus
    if(allowNeg&&v.lastIndexOf('-')>0){const first=v[0]==='-'?'-':'';v=first+v.replace(/-/g,'')}
    el.value=v;
}

fromAmt.addEventListener('input',()=>{lastEdited='from';sanitizeInput(fromAmt,getCat().isTemp);doConvert()});
fromAmt.addEventListener('focus',()=>{lastEdited='from';fromAmt.select()});
toAmt.addEventListener('input',()=>{lastEdited='to';sanitizeInput(toAmt,getCat().isTemp);doConvert()});
toAmt.addEventListener('focus',()=>{lastEdited='to';toAmt.select()});
fromSel.addEventListener('change',()=>{fromU=fromSel.value;lastEdited='from';doConvert()});
toSel.addEventListener('change',()=>{toU=toSel.value;lastEdited='from';doConvert()});

document.getElementById('swapBtn').addEventListener('click',()=>{
    const tmp=fromU;fromU=toU;toU=tmp;
    fromSel.value=fromU;toSel.value=toU;
    const tmpV=fromAmt.value;fromAmt.value=toAmt.value;toAmt.value=tmpV;
    lastEdited='from';doConvert();
});

// ============ INIT ============
(function init(){
    const cat=getCat();fromU=cat.dfFrom;toU=cat.dfTo;
    populateSelects();fromAmt.value='1';lastEdited='from';
    doConvert();updateRefs();
})();
</script>


</body></html>
