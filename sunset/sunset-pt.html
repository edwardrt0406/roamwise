<!DOCTYPE html><html lang="zh-Hant"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roamwise - Consulta de Hora do Nascer e P√¥r do Sol</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root{--primary:#2563eb;--primary-dark:#1d4ed8;--primary-light:#dbeafe;--accent:#f59e0b;--bg:#f0f4f8;--card:#fff;--text:#1e293b;--text-light:#64748b;--border:#e2e8f0;--radius:12px;--shadow:0 4px 24px rgba(0,0,0,.07);--shadow-sm:0 2px 8px rgba(0,0,0,.05)}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
        header{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(37,99,235,.3)}
        .logo{font-size:1.4rem;font-weight:700;letter-spacing:1px;display:flex;align-items:center;gap:8px}.logo span{color:var(--accent)}
        .header-right{display:flex;align-items:center;gap:16px}
        .header-right a{color:rgba(255,255,255,.85);text-decoration:none;font-size:.9rem;transition:color .2s}.header-right a:hover{color:#fff}
        .lang-select{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);color:#fff;padding:6px 12px;border-radius:8px;font-size:.85rem;cursor:pointer;font-family:inherit}.lang-select option{color:#333;background:#fff}
        main{flex:1;max-width:900px;width:100%;margin:0 auto;padding:32px 16px}
        .page-title{text-align:center;font-size:1.7rem;font-weight:700;margin-bottom:24px;color:var(--primary-dark)}
        .info-box{background:var(--primary-light);border-left:4px solid var(--primary);border-radius:0 var(--radius) var(--radius) 0;padding:16px 20px;margin-bottom:28px;display:flex;gap:12px;align-items:flex-start;font-size:.92rem;color:var(--primary-dark);line-height:1.6}.info-box .icon{font-size:1.2rem;flex-shrink:0;margin-top:2px}
        .query-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:28px 24px;margin-bottom:28px}
        .selector-row{display:flex;gap:16px;align-items:flex-end;flex-wrap:wrap}
        .selector-group{flex:1;min-width:180px}
        .selector-group label{display:flex;align-items:center;gap:6px;font-weight:500;font-size:.95rem;margin-bottom:8px}
        .custom-select-wrapper{position:relative}
        .custom-select-wrapper input,.date-input{width:100%;padding:12px 16px;border:2px solid var(--border);border-radius:10px;font-size:1rem;font-family:inherit;transition:border-color .2s,box-shadow .2s;background:#fff}
        .custom-select-wrapper input:focus,.date-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(37,99,235,.12)}
        .dropdown-list{position:absolute;top:calc(100% + 4px);left:0;right:0;background:#fff;border:1px solid var(--border);border-radius:10px;max-height:260px;overflow-y:auto;box-shadow:var(--shadow);z-index:50;display:none}.dropdown-list.show{display:block}
        .dropdown-item{padding:10px 16px;cursor:pointer;font-size:.93rem;transition:background .15s;display:flex;justify-content:space-between;align-items:center}.dropdown-item:hover,.dropdown-item.active{background:var(--primary-light);color:var(--primary-dark)}
        .dropdown-item .city-extra{font-size:.78rem;color:var(--text-light)}
        .dropdown-group-header{padding:8px 16px 4px;font-size:.78rem;font-weight:600;color:var(--primary);background:#f8fafc;text-transform:uppercase;letter-spacing:.5px;position:sticky;top:0}
        .search-btn-wrapper{flex-shrink:0}
        .search-btn{background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;border:none;padding:12px 32px;border-radius:10px;font-size:1rem;font-family:inherit;font-weight:500;cursor:pointer;transition:transform .15s,box-shadow .2s;display:flex;align-items:center;gap:8px;white-space:nowrap}
        .search-btn:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(37,99,235,.35)}.search-btn:active{transform:translateY(0)}
        .no-result{text-align:center;padding:48px 20px;color:var(--text-light);display:none}.no-result .big-icon{font-size:2.5rem;margin-bottom:12px}
        .result-container{display:none}.result-container.show{display:block}
        .result-header{text-align:center;margin-bottom:24px}.result-header h2{font-size:1.4rem;color:var(--primary-dark);margin-bottom:6px}.result-header p{font-size:.92rem;color:var(--text-light)}
        .main-times{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px}
        .time-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-sm);border:1px solid var(--border);padding:18px 14px;text-align:center}
        .time-card .t-icon{font-size:1.6rem;display:block;margin-bottom:6px}
        .time-card .t-label{font-size:.82rem;color:var(--text-light);display:block;margin-bottom:6px}
        .time-card .t-value{font-size:1.35rem;font-weight:700;color:var(--text);display:block;font-variant-numeric:tabular-nums;letter-spacing:1px}
        .time-card.sunrise{border-top:3px solid #f97316}.time-card.sunset{border-top:3px solid #8b5cf6}
        .time-card.daylen{border-top:3px solid #0ea5e9}.time-card.nightlen{border-top:3px solid #334155}
        .section-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow-sm);border:1px solid var(--border);padding:22px 20px;margin-bottom:20px}
        .section-card h3{font-size:1rem;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;color:var(--text)}
        .day-bar-wrap{position:relative;margin-bottom:8px}
        .day-bar{height:40px;border-radius:20px;overflow:hidden;position:relative}
        .bar-marker{position:absolute;top:0;height:100%;display:flex;flex-direction:column;align-items:center;transform:translateX(-50%);z-index:2;pointer-events:none}
        .bar-marker .m-line{width:2px;height:40px;flex-shrink:0}
        .bar-marker .m-line.white{background:rgba(255,255,255,.85)}.bar-marker .m-line.red{background:#dc2626;width:3px}
        .bar-marker .m-label{font-size:.68rem;margin-top:4px;white-space:nowrap;font-weight:500}
        .bar-marker .m-label.red{color:#dc2626;font-weight:700}
        .bar-hours{display:flex;justify-content:space-between;font-size:.7rem;color:var(--text-light);padding:4px 2px 0;user-select:none}
        .status-banner{padding:14px 18px;border-radius:var(--radius);margin-bottom:20px;font-weight:500;font-size:.95rem;display:flex;align-items:center;gap:10px;line-height:1.5}
        .status-banner.day{background:#fef3c7;color:#92400e;border:1px solid #fde68a}
        .status-banner.twilight{background:#e0e7ff;color:#3730a3;border:1px solid #c7d2fe}
        .status-banner.night{background:#1e293b;color:#94a3b8;border:1px solid #334155}
        .status-banner.polar{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
        .detail-grid{display:grid;gap:0}
        .detail-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid #f1f5f9;font-size:.93rem}.detail-row:last-child{border-bottom:none}
        .detail-row .dl{color:var(--text-light)}.detail-row .dv{font-weight:600;text-align:right}
        .trend-table{width:100%;border-collapse:collapse;font-size:.88rem}
        .trend-table th{text-align:left;padding:8px 10px;font-weight:500;color:var(--text-light);border-bottom:2px solid var(--border);font-size:.82rem}
        .trend-table td{padding:8px 10px;border-bottom:1px solid #f1f5f9;font-variant-numeric:tabular-nums}
        .trend-table tr.today{background:#eff6ff;font-weight:600}
        .trend-table .change{font-size:.78rem;border-radius:20px;padding:2px 8px;display:inline-block}
        .change.up{background:#dcfce7;color:#15803d}.change.down{background:#fee2e2;color:#b91c1c}.change.same{background:#f1f5f9;color:#64748b}
        .calc-note{font-size:.82rem;color:var(--text-light);line-height:1.6;padding:12px 16px;background:#f8fafc;border-radius:8px;margin-top:20px}
        footer{background:#1e293b;color:rgba(255,255,255,.7);padding:36px 24px 20px;margin-top:auto}
        .footer-grid{max-width:900px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:28px;margin-bottom:28px}
        .footer-col h4{color:#fff;font-size:.95rem;margin-bottom:12px;display:flex;align-items:center;gap:6px}
        .footer-col a{display:block;color:rgba(255,255,255,.6);text-decoration:none;font-size:.88rem;padding:4px 0;transition:color .2s}.footer-col a:hover{color:#fff}
        .footer-col a.active-link{color:var(--accent);font-weight:500}
        .footer-bottom{text-align:center;border-top:1px solid rgba(255,255,255,.1);padding-top:16px;font-size:.82rem}.footer-bottom a{color:rgba(255,255,255,.5);text-decoration:none}.footer-bottom a:hover{color:#fff}
        @media(max-width:640px){
            .page-title{font-size:1.3rem}
            .selector-row{flex-direction:column}.selector-group{min-width:100%}
            .search-btn-wrapper{width:100%}.search-btn{width:100%;justify-content:center}
            .main-times{grid-template-columns:1fr 1fr}
            .time-card .t-value{font-size:1.15rem}
            .header-right a.contact-link{display:none}
        }
    </style>
</head>
<body>
<header>
    <div class="logo">
        <img src="logo.png" alt="Roamwise Logo" class="logo-img">
        Roam<span>wise</span>
    </div>
    <div class="header-right">
        <a href="#" class="contact-link">Contacte-nos</a>
        <select class="lang-select" onchange="changeLanguage(this.value)">
            <option value="sunset-pt.html" selected="">Portugu√™s</option>
            <option value="sunset-en.html">English</option>
            <option value="sunset-es.html">Espa√±ol</option>
            <option value="sunset-zh.html">ÁπÅÈ´î‰∏≠Êñá</option>
        </select>
    </div>
</header>

<script>
    function changeLanguage(filename) {
        window.location.href = filename;
    }
</script>
<main>
   <h1 class="page-title">üåÖ Consulta de Hora do Nascer e P√¥r do Sol</h1>
    <div class="info-box"><span class="icon">‚ÑπÔ∏è</span><div>Seleccione uma cidade e data para consultar o nascer e p√¥r do sol, crep√∫sculos, dura√ß√£o do dia e os melhores momentos para fotografia. Suporta mais de 115 cidades em todo o mundo, com c√°lculos em tempo real usando algoritmos astron√≥micos.</div></div>
    <div class="query-card">
        <div class="selector-row">
            <div class="selector-group" style="flex:2">
                <label>üèôÔ∏è Seleccione uma Cidade</label>
                <div class="custom-select-wrapper">
                    <input type="text" id="cityInput" placeholder="Introduza o nome da cidade ou pa√≠s‚Ä¶" autocomplete="off">
                    <div class="dropdown-list" id="cityDropdown"></div>
                </div>
            </div>
            <div class="selector-group" style="flex:1">
                <label>üìÖ Data</label>
                <input type="date" class="date-input" id="dateInput">
            </div>
            <div class="search-btn-wrapper">
                <button class="search-btn" id="searchBtn">üîç Consultar</button>
            </div>
        </div>
    </div>
    <div class="no-result" id="noResult"><div class="big-icon">üîç</div><p>Sem resultados</p><p style="font-size:.85rem">Verifique se o nome da cidade est√° correto ou seleccione na lista pendente</p></div>
    <div class="result-container" id="resultContainer">
        <div class="result-header"><h2 id="rHeader"></h2><p id="rSubheader"></p></div>
        <div class="main-times">
            <div class="time-card sunrise"><span class="t-icon">üåÖ</span><span class="t-label">Nascer do Sol</span><span class="t-value" id="rSunrise">--:--</span></div>
            <div class="time-card sunset"><span class="t-icon">üåá</span><span class="t-label">P√¥r do Sol</span><span class="t-value" id="rSunset">--:--</span></div>
            <div class="time-card daylen"><span class="t-icon">‚òÄÔ∏è</span><span class="t-label">Dura√ß√£o do Dia</span><span class="t-value" id="rDayLen">--</span></div>
            <div class="time-card nightlen"><span class="t-icon">üåô</span><span class="t-label">Dura√ß√£o da Noite</span><span class="t-value" id="rNightLen">--</span></div>
        </div>
        <div class="section-card">
            <h3>üïê Eixo Temporal de Luz Solar</h3>
            <div class="day-bar-wrap">
                <div class="day-bar" id="dayBar"></div>
            </div>
            <div class="bar-hours"><span>00</span><span>03</span><span>06</span><span>09</span><span>12</span><span>15</span><span>18</span><span>21</span><span>24</span></div>
        </div>
        <div class="status-banner" id="statusBanner"></div>
        <div class="section-card">
            <h3>üìã Hor√°rios Detalhados</h3>
            <div class="detail-grid">
                <div class="detail-row"><span class="dl">Crep√∫sculo Astron√≥mico (-18¬∞)</span><span class="dv" id="rAstro"></span></div>
                <div class="detail-row"><span class="dl">Crep√∫sculo N√°utico (-12¬∞)</span><span class="dv" id="rNaut"></span></div>
                <div class="detail-row"><span class="dl">Crep√∫sculo Civil (-6¬∞)</span><span class="dv" id="rCivil"></span></div>
                <div class="detail-row"><span class="dl">Nascer / P√¥r do Sol</span><span class="dv" id="rOfficial"></span></div>
                <div class="detail-row"><span class="dl">Meio-dia Solar</span><span class="dv" id="rNoon"></span></div>
                <div class="detail-row"><span class="dl">Eleva√ß√£o M√°xima ao Meio-dia</span><span class="dv" id="rElev"></span></div>
            </div>
        </div>
       <div class="section-card">
            <h3>üì∑ Momentos de Ouro para Fotografia</h3>
            <div class="detail-grid">
                <div class="detail-row"><span class="dl">üåÖ Hora de Ouro Matinal</span><span class="dv" id="rGoldAM"></span></div>
                <div class="detail-row"><span class="dl">üåÜ Hora de Ouro Vespertina</span><span class="dv" id="rGoldPM"></span></div>
                <div class="detail-row"><span class="dl">üîµ Hora Azul Matinal</span><span class="dv" id="rBlueAM"></span></div>
                <div class="detail-row"><span class="dl">üîµ Hora Azul Vespertina</span><span class="dv" id="rBluePM"></span></div>
            </div>
        </div>
        <div class="section-card">
            <h3>üìä Compara√ß√£o de Dias Anteriores e Posteriores</h3>
            <table class="trend-table">
                <thead><tr><th>Data</th><th>Nascer do Sol</th><th>P√¥r do Sol</th><th>Dura√ß√£o do Dia</th><th>Varia√ß√£o</th></tr></thead>
                <tbody id="trendBody"></tbody>
            </table>
        </div>
        <div class="calc-note">‚ö†Ô∏è Os resultados acima s√£o c√°lculos aproximados usando algoritmos astron√≥micos, podendo ter uma margem de erro de 1-2 minutos e n√£o consideram obstru√ß√µes topogr√°ficas nem varia√ß√µes da refrac√ß√£o atmosf√©rica local. Cidades pr√≥ximas dos p√≥los podem apresentar dias polares ou noites polares perto do solst√≠cio.</div>
    </div>
</main>
    
<footer class="hide-f">
<div class="footer-grid">
    <div class="footer-col">
        <h4>üîå Energia e Hora</h4>
        <a href="plug/plug-pt.html" class="active-link">Padr√µes de Fichas</a>
        <a href="time-zone/time-zone-pt.html">Consulta de Fusos Hor√°rios</a>
        <a href="sunset/sunset-pt.html">Hora do Nascer e P√¥r do Sol</a>
        <a href="timer/timer-pt.html">Temporizador</a>
    </div>
    <div class="footer-col">
        <h4>üéâ F√©rias e Eventos</h4>
        <a href="#">Consulta de F√©rias Locais</a>
        <a href="#">Festividades e Eventos</a>
    </div>
    <div class="footer-col">
        <h4>üí± Finan√ßas e Unidades</h4>
        <a href="currency/currency-pt.html">Conversor de Taxas de C√¢mbio</a>
        <a href="unit/unit-pt.html">Conversor de Unidades</a>
    </div>
    <div class="footer-col">
        <h4>üåç Informa√ß√µes de Viagem</h4>
        <a href="#">Informa√ß√µes B√°sicas de Pa√≠ses</a>
        <a href="#">Guias Detalhados de Regi√µes</a>
    </div>
</div>
    <div class="ft-bot">¬© 2026 Roamwise. Todos os direitos reservados. | <a href="#">Pol√≠tica de Privacidade</a> | <a href="#">Termos de Uso</a></div>
</footer>
<script>
// ============ CITY DATA ============
// [city, country, region, iana, lat, lng]
const raw=[
["Lisboa","Portugal","Europa","Europe/Lisbon",38.72,-9.14],
["Amesterd√£o","Pa√≠ses Baixos","Europa","Europe/Amsterdam",52.37,4.90],
["Bruxelas","B√©lgica","Europa","Europe/Brussels",50.85,4.35],
["Zurique","Su√≠√ßa","Europa","Europe/Zurich",47.38,8.54],
["Genebra","Su√≠√ßa","Europa","Europe/Zurich",46.20,6.14],
["Viena","√Åustria","Europa","Europe/Vienna",48.21,16.37],
["Estocolmo","Su√©cia","Europa","Europe/Stockholm",59.33,18.07],
["Oslo","Noruega","Europa","Europe/Oslo",59.91,10.75],
["Copenhaga","Dinamarca","Europa","Europe/Copenhagen",55.68,12.57],
["Helsinque","Finl√¢ndia","Europa","Europe/Helsinki",60.17,24.94],
["Reykjav√≠k","Isl√¢ndia","Europa","Atlantic/Reykjavik",64.15,-21.94],
["Dublin","Irlanda","Europa","Europe/Dublin",53.35,-6.26],
["Atenas","Gr√©cia","Europa","Europe/Athens",37.98,23.73],
["Vars√≥via","Pol√≥nia","Europa","Europe/Warsaw",52.23,21.01],
["Praga","Rep√∫blica Checa","Europa","Europe/Prague",50.08,14.44],
["Budapeste","Hungria","Europa","Europe/Budapest",47.50,19.04],
["Zagreb","Cro√°cia","Europa","Europe/Zagreb",45.82,15.98],
["Moscovo","R√∫ssia","Europa","Europe/Moscow",55.76,37.62],
["S√£o Petersburgo","R√∫ssia","Europa","Europe/Moscow",59.93,30.36],
["Ecaterimburgo","R√∫ssia","Europa","Asia/Yekaterinburg",56.84,60.61],
["Novosibirsk","R√∫ssia","Europa","Asia/Novosibirsk",55.01,82.94],
["Vladivostoque","R√∫ssia","Europa","Asia/Vladivostok",43.13,131.91],
["Kiev","Ucr√¢nia","Europa","Europe/Kyiv",50.45,30.52],
["Riga","Let√≥nia","Europa","Europe/Riga",56.95,24.11],
["Monte Carlo","M√≥naco","Europa","Europe/Monaco",43.74,7.42],
["Nova Iorque","Estados Unidos","Am√©rica do Norte","America/New_York",40.71,-74.01],
["Washington D.C.","Estados Unidos","Am√©rica do Norte","America/New_York",38.91,-77.04],
["Boston","Estados Unidos","Am√©rica do Norte","America/New_York",42.36,-71.06],
["Miami","Estados Unidos","Am√©rica do Norte","America/New_York",25.76,-80.19],
["Atlanta","Estados Unidos","Am√©rica do Norte","America/New_York",33.75,-84.39],
["Chicago","Estados Unidos","Am√©rica do Norte","America/Chicago",41.88,-87.63],
["Houston","Estados Unidos","Am√©rica do Norte","America/Chicago",29.76,-95.37],
["Dallas","Estados Unidos","Am√©rica do Norte","America/Chicago",32.78,-96.80],
["Denver","Estados Unidos","Am√©rica do Norte","America/Denver",39.74,-104.99],
["F√©nix","Estados Unidos","Am√©rica do Norte","America/Phoenix",33.45,-112.07],
["Los Angeles","Estados Unidos","Am√©rica do Norte","America/Los_Angeles",34.05,-118.24],
["S√£o Francisco","Estados Unidos","Am√©rica do Norte","America/Los_Angeles",37.77,-122.42],
["Seattle","Estados Unidos","Am√©rica do Norte","America/Los_Angeles",47.61,-122.33],
["Las Vegas","Estados Unidos","Am√©rica do Norte","America/Los_Angeles",36.17,-115.14],
["Ancoragem","Estados Unidos","Am√©rica do Norte","America/Anchorage",61.22,-149.90],
["Honolulu","Estados Unidos","Am√©rica do Norte","Pacific/Honolulu",21.31,-157.86],
["Toronto","Canad√°","Am√©rica do Norte","America/Toronto",43.65,-79.38],
["Montreal","Canad√°","Am√©rica do Norte","America/Toronto",45.50,-73.57],
["Otava","Canad√°","Am√©rica do Norte","America/Toronto",45.42,-75.70],
["Calgary","Canad√°","Am√©rica do Norte","America/Edmonton",51.04,-114.07],
["Vancouver","Canad√°","Am√©rica do Norte","America/Vancouver",49.28,-123.12],
["Cidade do M√©xico","M√©xico","Am√©rica do Norte","America/Mexico_City",19.43,-99.13],
["Cancun","M√©xico","Am√©rica do Norte","America/Cancun",21.16,-86.85],
["Havana","Cuba","Am√©rica do Norte","America/Havana",23.11,-82.37],
["Cidade do Panam√°","Panam√°","Am√©rica do Norte","America/Panama",8.98,-79.52],
["San Jos√©","Costa Rica","Am√©rica do Norte","America/Costa_Rica",9.93,-84.09],
["S√£o Paulo","Brasil","Am√©rica do Sul","America/Sao_Paulo",-23.55,-46.63],
["Rio de Janeiro","Brasil","Am√©rica do Sul","America/Sao_Paulo",-22.91,-43.17],
["Buenos Aires","Argentina","Am√©rica do Sul","America/Argentina/Buenos_Aires",-34.60,-58.38],
["Santiago","Chile","Am√©rica do Sul","America/Santiago",-33.45,-70.67],
["Bogot√°","Col√¥mbia","Am√©rica do Sul","America/Bogota",4.71,-74.07],
["Lima","Peru","Am√©rica do Sul","America/Lima",-12.05,-77.04],
["Montevid√©u","Uruguai","Am√©rica do Sul","America/Montevideo",-34.90,-56.16],
["Sydney","Austr√°lia","Oce√¢nia","Australia/Sydney",-33.87,151.21],
["Melbourne","Austr√°lia","Oce√¢nia","Australia/Melbourne",-37.81,144.96],
["Brisbane","Austr√°lia","Oce√¢nia","Australia/Brisbane",-27.47,153.03],
["Perth","Austr√°lia","Oce√¢nia","Australia/Perth",-31.95,115.86],
["Adelaide","Austr√°lia","Oce√¢nia","Australia/Adelaide",-34.93,138.60],
["Auckland","Nova Zel√¢ndia","Oce√¢nia","Pacific/Auckland",-36.85,174.76],
["Wellington","Nova Zel√¢ndia","Oce√¢nia","Pacific/Auckland",-41.29,174.78],
["Suva","Fiji","Oce√¢nia","Pacific/Fiji",-18.14,178.44],
["Cairo","Egipto","√Åfrica","Africa/Cairo",30.04,31.24],
["Joanesburgo","√Åfrica do Sul","√Åfrica","Africa/Johannesburg",-26.20,28.05],
["Cidade do Cabo","√Åfrica do Sul","√Åfrica","Africa/Johannesburg",-33.92,18.42],
["Nairobi","Qu√©nia","√Åfrica","Africa/Nairobi",-1.29,36.82],
["Casablanca","Marrocos","√Åfrica","Africa/Casablanca",33.57,-7.59],
["Maraqueche","Marrocos","√Åfrica","Africa/Casablanca",31.63,-7.98],
["Lagos","Nig√©ria","√Åfrica","Africa/Lagos",6.52,3.38],
["Dar es Salaam","Tanz√¢nia","√Åfrica","Africa/Dar_es_Salaam",-6.79,39.21],
["Acra","Gana","√Åfrica","Africa/Accra",5.60,-0.19],
["Adis Abeba","Eti√≥pia","√Åfrica","Africa/Addis_Ababa",9.03,38.75]
];

const regionOrder=["√Åsia","M√©dio Oriente","Europa","Am√©rica do Norte","Am√©rica do Sul","Oce√¢nia","√Åfrica"];
const cities=raw.map(r=>({city:r[0],country:r[1],region:r[2],iana:r[3],lat:r[4],lng:r[5],label:r[0]+"Ôºà"+r[1]+"Ôºâ"}));
const cityMap={};cities.forEach(c=>cityMap[c.label]=c);

// ============ DROPDOWN ============
(function(){
    const input=document.getElementById('cityInput'),dd=document.getElementById('cityDropdown');
    function render(f){
        f=(f||'').trim().toLowerCase();
        const m=f?cities.filter(c=>c.city.toLowerCase().includes(f)||c.country.toLowerCase().includes(f)):cities;
        const g={};regionOrder.forEach(r=>g[r]=[]);m.forEach(c=>{if(g[c.region])g[c.region].push(c)});
        dd.innerHTML='';let n=0;
        regionOrder.forEach(r=>{if(!g[r]||!g[r].length)return;const h=document.createElement('div');h.className='dropdown-group-header';h.textContent=r;dd.appendChild(h);
            g[r].forEach(c=>{const d=document.createElement('div');d.className='dropdown-item';d.innerHTML='<span>'+c.city+'Ôºà'+c.country+'Ôºâ</span><span class="city-extra">'+c.lat.toFixed(1)+'¬∞, '+c.lng.toFixed(1)+'¬∞</span>';
            d.addEventListener('mousedown',e=>{e.preventDefault();input.value=c.label;dd.classList.remove('show')});dd.appendChild(d);n++})});
        if(!n){const d=document.createElement('div');d.className='dropdown-item';d.textContent='Nenhuma cidade correspondente encontrada';d.style.color='#94a3b8';dd.appendChild(d)}
    }
    input.addEventListener('focus',()=>{render(input.value);dd.classList.add('show')});
    input.addEventListener('input',()=>{render(input.value);dd.classList.add('show')});
    input.addEventListener('blur',()=>setTimeout(()=>dd.classList.remove('show'),200));
})();

// Default date = today
document.getElementById('dateInput').valueAsDate=new Date();

// ============ SUN CALCULATION ============
function getOffset(iana,y,m,d){
    const dt=new Date(Date.UTC(y,m-1,d,12,0,0));
    const u=dt.toLocaleString('en-US',{timeZone:'UTC'});
    const t=dt.toLocaleString('en-US',{timeZone:iana});
    return(new Date(t)-new Date(u))/36e5;
}
function doy(y,m,d){return Math.floor((new Date(y,m-1,d)-new Date(y,0,0))/864e5)}
function calcSun(lat,lng,y,m,d,iana){
    const off=getOffset(iana,y,m,d);
    const n=doy(y,m,d);
    const gamma=(2*Math.PI/365)*(n-1+0.5);
    const eqtime=229.18*(0.000075+0.001868*Math.cos(gamma)-0.032077*Math.sin(gamma)-0.014615*Math.cos(2*gamma)-0.040849*Math.sin(2*gamma));
    const decl=0.006918-0.399912*Math.cos(gamma)+0.070257*Math.sin(gamma)-0.006758*Math.cos(2*gamma)+0.000907*Math.sin(2*gamma)-0.002697*Math.cos(3*gamma)+0.00148*Math.sin(3*gamma);
    const snoon=720-4*lng-eqtime+off*60;
    const latR=lat*Math.PI/180;
    function getTimes(zenith){
        const zR=zenith*Math.PI/180;
        const cosH=(Math.cos(zR)-Math.sin(latR)*Math.sin(decl))/(Math.cos(latR)*Math.cos(decl));
        if(cosH>1)return{state:'never_rises'};
        if(cosH<-1)return{state:'never_sets'};
        const ha=Math.acos(cosH)*180/Math.PI;
        return{rise:snoon-ha*4,set:snoon+ha*4};
    }
    const official=getTimes(90.833);
    const civil=getTimes(96);
    const nautical=getTimes(102);
    const astro=getTimes(108);
    const golden=getTimes(84);
    const declDeg=decl*180/Math.PI;
    let maxElev=90-Math.abs(lat-declDeg);
    if(maxElev<0)maxElev=0;
    return{official,civil,nautical,astro,golden,snoon,maxElev,declDeg,off};
}

// ============ FORMATTING ============
function mt(m){
    if(!m&&m!==0||isNaN(m))return'--:--';
    let h=Math.floor(m/60),mn=Math.round(m%60);
    if(mn===60){h++;mn=0}h=((h%24)+24)%24;
    return String(h).padStart(2,'0')+':'+String(mn).padStart(2,'0');
}
function dur(m){
    if(!m&&m!==0||isNaN(m))return'--';
    m=Math.round(m);const h=Math.floor(m/60),mn=m%60;
    return h+' h '+mn+' min';
}
function fmtDate(y,m,d){
    const dt=new Date(y,m-1,d);
    const wd=['dom','seg','ter','qua','qui','sex','sab'][dt.getDay()];
    return d+'/'+String(m).padStart(2,'0')+'/'+y+' ('+wd+')';
}

// ============ SEARCH ============
document.getElementById('searchBtn').addEventListener('click',doSearch);
document.getElementById('cityInput').addEventListener('keydown',e=>{if(e.key==='Enter')doSearch()});

function doSearch(){
    const cVal=document.getElementById('cityInput').value.trim();
    const dStr=document.getElementById('dateInput').value;
    const noR=document.getElementById('noResult'),res=document.getElementById('resultContainer');
    const c=cityMap[cVal];
    if(!c||!dStr){noR.style.display='block';res.classList.remove('show');return}
    noR.style.display='none';res.classList.add('show');
    const[y,m,d]=dStr.split('-').map(Number);
    const sun=calcSun(c.lat,c.lng,y,m,d,c.iana);

    // Header
    document.getElementById('rHeader').textContent='üèôÔ∏è '+c.city+'Ôºà'+c.country+'Ôºâ';
    document.getElementById('rSubheader').textContent='üìÖ '+fmtDate(y,m,d)+'„ÄÄüìç '+c.lat.toFixed(2)+'¬∞N, '+c.lng.toFixed(2)+'¬∞E';

    // Main times
if(sun.official.state){
        const isPolar=sun.official.state==='never_rises';
        document.getElementById('rSunrise').textContent=isPolar?'Nunca sai':'Nunca se p√µe';
        document.getElementById('rSunset').textContent=isPolar?'Nunca sai':'Nunca se p√µe';
        document.getElementById('rDayLen').textContent=isPolar?'0 h 0 min':'24 h 0 min';
        document.getElementById('rNightLen').textContent=isPolar?'24 h 0 min':'0 h 0 min';
    }else{
        document.getElementById('rSunrise').textContent=mt(sun.official.rise);
        document.getElementById('rSunset').textContent=mt(sun.official.set);
        const dayMins=sun.official.set-sun.official.rise;
        document.getElementById('rDayLen').textContent=dur(dayMins);
        document.getElementById('rNightLen').textContent=dur(1440-dayMins);
    }

    // Visual bar
    renderBar(sun);

    // Status
    renderStatus(c,sun,y,m,d);

    // Details
    document.getElementById('rAstro').textContent=sun.astro.state?'‚Äî':mt(sun.astro.rise)+' / '+mt(sun.astro.set);
    document.getElementById('rNaut').textContent=sun.nautical.state?'‚Äî':mt(sun.nautical.rise)+' / '+mt(sun.nautical.set);
    document.getElementById('rCivil').textContent=sun.civil.state?'‚Äî':mt(sun.civil.rise)+' / '+mt(sun.civil.set);
    document.getElementById('rOfficial').textContent=sun.official.state?'‚Äî':mt(sun.official.rise)+' / '+mt(sun.official.set);
    document.getElementById('rNoon').textContent=mt(sun.snoon);
    document.getElementById('rElev').textContent=sun.maxElev.toFixed(1)+'¬∞';

    // Photography
    if(!sun.official.state&&!sun.golden.state){
        document.getElementById('rGoldAM').textContent=mt(sun.official.rise)+' ~ '+mt(sun.golden.rise);
        document.getElementById('rGoldPM').textContent=mt(sun.golden.set)+' ~ '+mt(sun.official.set);
    }else{
        document.getElementById('rGoldAM').textContent='‚Äî';
        document.getElementById('rGoldPM').textContent='‚Äî';
    }
    if(!sun.official.state&&!sun.civil.state){
        document.getElementById('rBlueAM').textContent=mt(sun.civil.rise)+' ~ '+mt(sun.official.rise);
        document.getElementById('rBluePM').textContent=mt(sun.official.set)+' ~ '+mt(sun.civil.set);
    }else{
        document.getElementById('rBlueAM').textContent='‚Äî';
        document.getElementById('rBluePM').textContent='‚Äî';
    }

    // Trend
    renderTrend(c,y,m,d);

    res.scrollIntoView({behavior:'smooth',block:'start'});
}

// ============ VISUAL BAR ============
function renderBar(sun){
    const bar=document.getElementById('dayBar');
    bar.innerHTML='';
    function pct(m){return Math.max(0,Math.min(100,m/1440*100))}

    if(sun.official.state){
        bar.style.background=sun.official.state==='never_rises'?'linear-gradient(135deg,#0f172a,#1e293b)':'linear-gradient(135deg,#38bdf8,#7dd3fc)';
        bar.style.height='40px';bar.style.borderRadius='20px';return;
    }
    const cd=sun.civil.state?pct(sun.official.rise):pct(sun.civil.rise);
    const sr=pct(sun.official.rise);
    const ss=pct(sun.official.set);
    const ck=sun.civil.state?pct(sun.official.set):pct(sun.civil.set);

    bar.style.background=`linear-gradient(to right,#0f172a 0%,#0f172a ${cd}%,#334155 ${cd}%,#fb923c ${sr}%,#fbbf24 ${sr}%,#38bdf8 ${sr+3>ss-3?sr:sr+3}%,#38bdf8 ${ss-3<sr+3?ss:ss-3}%,#fbbf24 ${ss}%,#fb923c ${ss}%,#334155 ${ck}%,#0f172a ${ck}%,#0f172a 100%)`;
    bar.style.height='40px';bar.style.borderRadius='20px';bar.style.position='relative';bar.style.overflow='visible';

    function addMarker(mins,label,color){
        const mk=document.createElement('div');mk.className='bar-marker';mk.style.left=pct(mins)+'%';
        const ln=document.createElement('div');ln.className='m-line '+(color==='red'?'red':'white');
        const lb=document.createElement('div');lb.className='m-label'+(color==='red'?' red':'');lb.textContent=label;
        mk.appendChild(ln);mk.appendChild(lb);bar.appendChild(mk);
    }
 addMarker(sun.official.rise,mt(sun.official.rise),'white');
    addMarker(sun.official.set,mt(sun.official.set),'white');
    addMarker(sun.snoon,'Meio-dia','white');

    // Current time marker if today
    const today=new Date();const ds=document.getElementById('dateInput').value;
    const todayStr=today.getFullYear()+'-'+String(today.getMonth()+1).padStart(2,'0')+'-'+String(today.getDate()).padStart(2,'0');
    if(ds===todayStr){
        try{
            const nowStr=today.toLocaleTimeString('en-US',{timeZone:cities.find(x=>x.label===document.getElementById('cityInput').value.trim())?.iana||'UTC',hour12:false,hour:'2-digit',minute:'2-digit'});
            const[nh,nm]=nowStr.split(':').map(Number);
            addMarker(nh*60+nm,'Agora','red');
        }catch(e){}
    }
}

// ============ STATUS BANNER ============
function renderStatus(c,sun,y,m,d){
    const banner=document.getElementById('statusBanner');
    const today=new Date();
    const todayStr=today.getFullYear()+'-'+String(today.getMonth()+1).padStart(2,'0')+'-'+String(today.getDate()).padStart(2,'0');
    const ds=document.getElementById('dateInput').value;
    if(ds!==todayStr){
        banner.className='status-banner day';
        banner.innerHTML='üìÖ A mostrar dados de '+fmtDate(y,m,d)+' (n√£o √© hoje)';return;
    }
    if(sun.official.state){
        banner.className='status-banner polar';
        banner.innerHTML=sun.official.state==='never_rises'?'üåë Noite Polar ‚Äî O sol n√£o sair√° hoje':'‚òÄÔ∏è Dia Polar ‚Äî O sol n√£o se por√° hoje';return;
    }
    try{
        const nowStr=today.toLocaleTimeString('en-US',{timeZone:c.iana,hour12:false,hour:'2-digit',minute:'2-digit'});
        const[nh,nm]=nowStr.split(':').map(Number);const now=nh*60+nm;
        const sr=sun.official.rise,ss=sun.official.set;
        const cd=sun.civil.state?sr:sun.civil.rise,ck=sun.civil.state?ss:sun.civil.set;
        if(now<cd){banner.className='status-banner night';banner.innerHTML='üåë Noite ‚Äî Faltam aproximadamente '+dur(cd-now)+' para o amanhecer'}
        else if(now<sr){banner.className='status-banner twilight';banner.innerHTML='üåÜ Crep√∫sculo Matinal ‚Äî Faltam aproximadamente '+dur(sr-now)+' para a sa√≠da do sol'}
        else if(now<ss){banner.className='status-banner day';banner.innerHTML='‚òÄÔ∏è Dia ‚Äî Faltam aproximadamente '+dur(ss-now)+' para o p√¥r do sol'}
        else if(now<ck){banner.className='status-banner twilight';banner.innerHTML='üåÜ Crep√∫sculo Vespertino ‚Äî Faltam aproximadamente '+dur(ck-now)+' para o anoitecer'}
        else{banner.className='status-banner night';banner.innerHTML='üåë Noite ‚Äî O sol j√° se p√¥s hoje'}
    }catch(e){banner.className='status-banner day';banner.innerHTML='üìç Informa√ß√£o de hora local em '+c.city}
}

// ============ TREND TABLE ============
function renderTrend(c,y,m,d){
    const tbody=document.getElementById('trendBody');tbody.innerHTML='';
    const dates=[];
    for(let i=-1;i<=1;i++){
        const dt=new Date(y,m-1,d+i);
        dates.push({y:dt.getFullYear(),m:dt.getMonth()+1,d:dt.getDate(),offset:i});
    }
    let prevDayLen=null;
dates.forEach(dt=>{
        const s=calcSun(c.lat,c.lng,dt.y,dt.m,dt.d,c.iana);
        const tr=document.createElement('tr');
        if(dt.offset===0)tr.className='today';
        const dateLabel=dt.offset===-1?'Dia anterior':dt.offset===0?'‚ñ∂ '+dt.m+'/'+dt.d:' Dia seguinte';
        let srT='‚Äî',ssT='‚Äî',dlT='‚Äî',dayLen=null;
        if(!s.official.state){
            srT=mt(s.official.rise);ssT=mt(s.official.set);
            dayLen=s.official.set-s.official.rise;dlT=dur(dayLen);
        }else if(s.official.state==='never_sets'){dayLen=1440;dlT='24 h 0 min';srT='Nunca se p√µe';ssT='Nunca se p√µe'}
        else{dayLen=0;dlT='0 h 0 min';srT='Nunca sai';ssT='Nunca sai'}
        let changeHtml='';
        if(prevDayLen!==null&&dayLen!==null){
            const diff=Math.round(dayLen-prevDayLen);
            if(diff>0)changeHtml='<span class="change up">+'+diff+' min</span>';
            else if(diff<0)changeHtml='<span class="change down">'+diff+' min</span>';
            else changeHtml='<span class="change same">¬±0</span>';
        }
        prevDayLen=dayLen;
        tr.innerHTML='<td>'+dateLabel+'</td><td>'+srT+'</td><td>'+ssT+'</td><td>'+dlT+'</td><td>'+changeHtml+'</td>';
        tbody.appendChild(tr);
    });
}
</script>


</body></html>
